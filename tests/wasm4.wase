include lib/wasm4;

import memory 1 = env.memory;

// Temporary offset until data is work correctly
data square = 0 offset 0xa0b0;
data moveText = "Move the square!" offset 0x25a0;

x : mutable i32 = 76;
y : mutable i32 = 76;

handleInput() -> () {
	gamepad : i32 = load<>(GAMEPAD1);

	if (gamepad & BUTTON_LEFT) {
		x := x - 1;
	};
	if (gamepad & BUTTON_RIGHT) {
		x := x + 1;
	};
	if (gamepad & BUTTON_UP) {
		y := y - 1;
	};
	if (gamepad & BUTTON_DOWN) {
		y := y + 1;
	};
}

export update() -> () {
	handleInput();

	store<>(DRAW_COLORS, 2);
	text(0x25a0, 24, 50);

	store<>(DRAW_COLORS, 3);
	blit(0xa0b0, x, y, 8, 8, 0)
}